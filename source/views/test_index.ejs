<!DOCTYPE html>
<html>
<%- include("./partials/head.ejs") %>
<body>
    scroll-padding-top: 123px;
    <!-- toolbar -->
    <%- include("./partials/toolbar.ejs") %>

    <!-- main banner -->
    <div id="carouselExampleIndicators" class="carousel slide" style="margin-top: 85px;">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4"></button>
        </div>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="/image/banner/banner1.png" class="d-block" alt="banner1">
            </div>
            <div class="carousel-item">
                <img src="/image/banner/banner2.png" class="d-block" alt="banner2">
            </div>
            <div class="carousel-item">
                <img src="/image/banner/banner3.png" class="d-block" alt="banner3">
            </div>
            <div class="carousel-item">
                <img src="/image/banner/banner4.png" class="d-block" alt="banner4">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>

    <!--  -->
    <section>
        <section class="Sach">
            <div class="product">
                <div class="header2">
                    <h2>SÁCH MỚI</h2>
                </div>
                <div class="items">
                    <% if (sps.length > 0) { %>
                        <% const recentlyAddedBooks = sps.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt)); %>
                        <% const maxBooksToShow = Math.min(5, recentlyAddedBooks.length); %>
                        <% for (let i = 0; i < maxBooksToShow; i++) { %>
                            <% const book = recentlyAddedBooks[i]; %>
                            <div class="item">
                                <img src="<%= book.img_small2 %>" onclick="location.href='/main/<%= book.id %>'" alt="">
                                <ul class="text">
                                    <li class="ten-sach" onclick="location.href='/main/<%= book.id %>'"><%= book.tensach %></li>
                                    <li class="gia-tien"><%= book.giagiam %></li>
                                    <li class="gia-goc"><%= book.giagoc %></li>
                                </ul>
                            </div>
                        <% } %>
                    <% } %>
                </div>
                <div class="xemthem">
                    <button data-target="sachmoi">Xem thêm</button>
                </div>
            </div>
        </section>

        <section class="Sach">
            <div class="product">
                <div class="header2">
                    <h2>SÁCH BÁN CHẠY</h2>
                </div>
                <div class="items">
                    <% if (sps.length > 0) { %>
                        <% const bestSellingBooks = sps.sort((a, b) => parseInt(b.luotban) - parseInt(a.luotban)); %>
                        <% const maxBestSellingBooks = Math.min(5, bestSellingBooks.length); %>
                        <% for (let j = 0; j < maxBestSellingBooks; j++) { %>
                            <% const book1 = bestSellingBooks[j]; %>
                            <div class="item">
                                <img src=<%= book1.img_small2 %> onclick="location.href='/main/<%= book1.id %>'" alt="">
                                <ul class="text">
                                    <li class="ten-sach" onclick="location.href='/main/<%= book1.id %>'"><%= book1.tensach %></li>
                                    <li class="gia-tien"><%= book1.giagiam %></li>
                                    <li class="gia-goc"><%= book1.giagoc %></li>
                                </ul>
                            </div>
                        <% } %>
                    <% } %>
                </div>
                <div class="xemthem">
                    <button data-target="sachbanchay">Xem thêm</button>
                </div>
            </div>
        </section>

        <div style="display: flex; justify-content: center;">
            <img class="banner-nxb" src="/image/banner/NXBkimdong.png" alt="">
        </div>

        <section class="Sach">
            <div class="product">
                <div class="header2">
                    <h2>NHÀ XUẤT BẢN KIM ĐỒNG</h2>
                </div>
                <div class="items">
                    <% let count = 0; %>
                    <% if (sps.length > 0) { %>
                        <% sps.forEach(sp => { %>
                            <% if (sp.nxb === 'Kim Đồng' && count < 5) { %>
                                <div class="item">
                                    <img src=<%= sp.img_small2 %> onclick="location.href='/main/<%= sp.id %>'" alt="">
                                    <ul class="text">
                                        <li class="ten-sach" onclick="location.href='/main/<%= sp.id %>'"><%= sp.tensach %></li>
                                        <li class="gia-tien"><%= sp.giagiam %></li>
                                        <li class="gia-goc"><%= sp.giagoc %></li>
                                    </ul>
                                </div>
                                <% count++; %>
                            <% } %>
                        <% }) %>    
                    <% } %>
                </div>
                <div class="xemthem">
                    <button data-target="nxbkimdong">Xem thêm</button>
                </div>
            </div>
        </section>

        <div style="display: flex; justify-content: center;">
            <img class="banner-nxb" src="/image/banner/NXBnhanam.png" alt="">
        </div>
        <section class="Sach">
            <div class="product">
                <div class="header2">
                    <h2>NHÀ XUẤT BẢN NHÃ NAM</h2>
                </div>
                <div class="items">
                    <% let count1 = 0; %>
                    <% if (sps.length > 0) { %>
                        <% sps.forEach(sp => { %>
                            <% if (sp.nxb === 'Nhã Nam' && count1 < 5) { %>
                                <div class="item">
                                    <img src=<%= sp.img_small2 %> onclick="location.href='/main/<%= sp.id %>'" alt="">
                                    <ul class="text">
                                        <li class="ten-sach" onclick="location.href='/main/<%= sp.id %>'"><%= sp.tensach %></li>
                                        <li class="gia-tien"><%= sp.giagiam %></li>
                                        <li class="gia-goc"><%= sp.giagoc %></li>
                                    </ul>
                                </div>
                                <% count1++; %>
                            <% } %>
                        <% }) %>    
                    <% } %>
                </div> 
                <div class="xemthem">
                    <button data-target="nxbnhanam">Xem thêm</button>
                </div>
            </div>
        </section>

        <script src="js/productJS/xemThem.js"></script>
        <script src="js/productJS/search.js"></script>
    </section>
    <!--footer-->
    <%- include("./partials/footer.ejs") %>
</body>
</html>